<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeakFluent - 英语对话机器人</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- 介绍页面 -->
        <div id="introPage" class="page active">
            <div class="intro-header">
                <div class="logo">
                    <h1>SpeakFluent</h1>
                    <p class="tagline">智能英语对话学习助手</p>
                </div>
            </div>
            
            <div class="intro-content">
                <div class="hero-section">
                    <div class="hero-text">
                        <h2>开启您的英语学习之旅</h2>
                        <p class="hero-description">
                            SpeakFluent 是一款智能英语对话机器人，通过AI模拟真实对话场景，提供即时反馈与个性化指导，助您高效提升英语水平。
                        </p>
                        <div class="hero-features">
                            <div class="feature-item">
                                <span class="feature-icon">🎯</span>
                                <span>多场景口语对话</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">🔊</span>
                                <span>实时语音交互</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">📊</span>
                                <span>发音与语法分析</span>
                            </div>
                            <div class="feature-item">
                                <span class="feature-icon">🎓</span>
                                <span>个性化学习路径</span>
                            </div>
                        </div>
                    </div>
                    <div class="hero-visual">
                        <div class="floating-card card-1">
                            <div class="card-content">
                                <span class="card-icon">💬</span>
                                <h4>智能对话</h4>
                                <p>AI模拟真实对话场景</p>
                            </div>
                        </div>
                        <div class="floating-card card-2">
                            <div class="card-content">
                                <span class="card-icon">🎤</span>
                                <h4>语音交互</h4>
                                <p>实时录音与播放</p>
                            </div>
                        </div>
                        <div class="floating-card card-3">
                            <div class="card-content">
                                <span class="card-icon">📈</span>
                                <h4>进度追踪</h4>
                                <p>学习记录与分析</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="features-section">
                    <h3>核心功能</h3>
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon-large">🏠</div>
                            <h4>多场景对话</h4>
                            <p>覆盖生活、职场、学习等高频场景，AI扮演对应角色启动沉浸式对话</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon-large">🔊</div>
                            <h4>实时语音交互</h4>
                            <p>精准转写用户语音指令，识别准确率高，AI响应迅速，延迟低</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon-large">🎵</div>
                            <h4>发音优化</h4>
                            <p>音素级分析，对比标准发音标注错误音素，检测语调与流利度</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon-large">📝</div>
                            <h4>语法纠正</h4>
                            <p>实时提示修正语法与用词错误，解释规则，推荐地道表达</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon-large">🎯</div>
                            <h4>个性化指导</h4>
                            <p>通过初始测试评估用户水平，动态调整对话难度，定制专属学习内容</p>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon-large">📊</div>
                            <h4>进度分析</h4>
                            <p>完整的历史记录功能，追踪学习进度，分析薄弱环节</p>
                        </div>
                    </div>
                </div>

                <div class="cta-section">
                    <h3>立即开始您的英语提升之旅</h3>
                    <p>加入数千名正在使用SpeakFluent提升英语水平的学习者</p>
                    <div class="cta-buttons">
                        <button class="cta-button primary" onclick="showPage('registerPage')">
                            免费注册
                        </button>
                        <button class="cta-button secondary" onclick="showPage('loginPage')">
                            已有账号登录
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 登录页面 -->
        <div id="loginPage" class="page">
            <div class="auth-header">
                <button class="back-button" onclick="showPage('introPage')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                    返回
                </button>
                <h1>SpeakFluent</h1>
            </div>
            <div class="auth-form-container">
                <div class="auth-card">
                    <h2>欢迎回来</h2>
                    <p class="auth-subtitle">继续您的英语学习之旅</p>
                    <form id="loginForm">
                        <div class="form-group">
                            <label for="username">用户名</label>
                            <input type="text" id="username" placeholder="请输入用户名" required>
                        </div>
                        <div class="form-group">
                            <label for="password">密码</label>
                            <input type="password" id="password" placeholder="请输入密码" required>
                        </div>
                        <button type="submit" class="auth-button">登录</button>
                    </form>
                    <div class="auth-switch">
                        <span>还没有账号？</span>
                        <button onclick="showPage('registerPage')">立即注册</button>
                    </div>
                    <div id="loginMessage" class="message-container"></div>
                </div>
            </div>
        </div>

        <!-- 注册页面 -->
        <div id="registerPage" class="page">
            <div class="auth-header">
                <button class="back-button" onclick="showPage('introPage')">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                    </svg>
                    返回
                </button>
                <h1>SpeakFluent</h1>
            </div>
            <div class="auth-form-container">
                <div class="auth-card">
                    <h2>创建账号</h2>
                    <p class="auth-subtitle">开启您的英语学习之旅</p>
                    <form id="registerForm">
                        <div class="form-group">
                            <label for="regUsername">用户名</label>
                            <input type="text" id="regUsername" placeholder="请设置用户名" required>
                        </div>
                        <div class="form-group">
                            <label for="regPassword">密码</label>
                            <input type="password" id="regPassword" placeholder="请设置密码" required>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">确认密码</label>
                            <input type="password" id="confirmPassword" placeholder="请再次输入密码" required>
                        </div>
                        <button type="submit" class="auth-button">注册</button>
                    </form>
                    <div class="auth-switch">
                        <span>已有账号？</span>
                        <button onclick="showPage('loginPage')">立即登录</button>
                    </div>
                    <div id="registerMessage" class="message-container"></div>
                </div>
            </div>
        </div>

        <!-- 主应用页面 -->
        <div id="mainPage" class="page">
            <!-- 侧边栏 -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <h2>SpeakFluent</h2>
                    <div class="user-info">
                        <span>欢迎，<span id="currentUserName">用户</span></span>
                        <button class="btn-icon" onclick="logout()" title="退出登录">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="sidebar-content">
                    <button class="new-chat-btn" onclick="createNewConversation()">
                        <span>+ 新的对话</span>
                    </button>
                    
                    <div class="conversations-section">
                        <h4>历史对话</h4>
                        <div class="conversations-list" id="conversationsList">
                            <div class="empty-state">
                                <p>还没有对话记录</p>
                                <small>开始新的对话来创建记录</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 主内容区 -->
            <div class="main-content">
                <!-- 场景选择页面 -->
                <div id="scenarioPage" class="content-page active">
                    <div class="scenario-header">
                        <h2>选择对话场景</h2>
                        <p>选择您想要练习的英语对话场景，AI将扮演对应角色与您对话</p>
                    </div>
                    
                    <div class="scenarios-grid">
                        <div class="scenario-card" onclick="selectScenario('daily_life')">
                            <div class="scenario-icon">🏠</div>
                            <h3>日常生活</h3>
                            <p>购物、餐饮、交通等日常对话练习</p>
                            <div class="scenario-level">初级</div>
                        </div>
                        
                        <div class="scenario-card" onclick="selectScenario('workplace')">
                            <div class="scenario-icon">💼</div>
                            <h3>职场商务</h3>
                            <p>会议、面试、商务沟通等场景</p>
                            <div class="scenario-level">中级</div>
                        </div>
                        
                        <div class="scenario-card" onclick="selectScenario('academic')">
                            <div class="scenario-icon">🎓</div>
                            <h3>学术学习</h3>
                            <p>课堂讨论、学术交流等场景</p>
                            <div class="scenario-level">中级</div>
                        </div>
                        
                        <div class="scenario-card" onclick="selectScenario('travel')">
                            <div class="scenario-icon">✈️</div>
                            <h3>旅行度假</h3>
                            <p>酒店、景点、问路等旅行对话</p>
                            <div class="scenario-level">初级</div>
                        </div>
                        
                        <div class="scenario-card" onclick="selectScenario('social')">
                            <div class="scenario-icon">👥</div>
                            <h3>社交活动</h3>
                            <p>派对、聚会、交友等社交场合</p>
                            <div class="scenario-level">中级</div>
                        </div>
                        
                        <div class="scenario-card" onclick="selectScenario('free_talk')">
                            <div class="scenario-icon">💬</div>
                            <h3>自由对话</h3>
                            <p>任意话题的开放式英语交流</p>
                            <div class="scenario-level">自适应</div>
                        </div>
                    </div>
                </div>

                <!-- 聊天页面 -->
                <div id="chatPage" class="content-page">
                    <div class="chat-header">
                        <button class="back-btn" onclick="showScenarioPage()">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
                            </svg>
                            返回场景
                        </button>
                        <div class="chat-info">
                            <h3 id="chatScenario">自由对话</h3>
                            <span id="chatLevel">自适应水平</span>
                        </div>
                        <button class="btn-secondary" onclick="endConversation()">结束对话</button>
                    </div>

                    <div class="chat-container">
                        <div class="messages-container" id="messagesContainer">
                            <div class="welcome-message">
                                <div class="ai-message">
                                    <div class="message-content">
                                        <p>Hello! I'm your English practice assistant. I'll help you improve your speaking skills through natural conversations. Let's start our conversation! What would you like to talk about today?</p>
                                        <span class="message-time">刚刚</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="chat-controls">
                            <div class="recorder-section">
                                <div class="record-status" id="recordStatus">
                                    <span>点击下方按钮开始录音对话</span>
                                </div>
                                <button id="recordButton" class="record-button" onclick="toggleRecording()">
                                    <span class="record-icon">🎤</span>
                                    <span class="record-text">开始录音</span>
                                </button>
                            </div>
                            
                            <div class="tts-controls">
                                <button class="btn-secondary" onclick="repeatLastMessage()" id="repeatBtn">
                                    🔄 重复上条消息
                                </button>
                                <button class="btn-secondary" onclick="adjustSpeechRate()" id="speedBtn">
                                    🐢 慢速播放
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 删除确认弹窗 -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <h3>确认删除</h3>
            <p>您确定要删除这条对话记录吗？此操作无法撤销。</p>
            <div class="modal-actions">
                <button class="btn-secondary" onclick="closeDeleteModal()">取消</button>
                <button class="btn-danger" id="confirmDeleteBtn">删除</button>
            </div>
        </div>
    </div>

    <!-- 加载脚本（加入简单版本号避免浏览器缓存旧脚本） -->
    <script src="tts.js?v=20251111"></script>
    <script src="app.js?v=20251111"></script>
</body>
</html>